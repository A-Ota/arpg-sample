(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19226302"],{1129:function(e,t,r){},"1a63":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[r("div",{ref:"pixi_area",staticStyle:{width:"320px",height:"240px"}}),r("b-button",{staticClass:"button",staticStyle:{bottom:"8px",right:"8px"},on:{click:e.onClickRun}},[e._v("走る")]),r("b-button",{staticClass:"button",staticStyle:{bottom:"8px",right:"8px"},on:{click:e.onClickReset}},[e._v("リセット")]),r("b-form-checkbox",{attrs:{id:"exactly-move"},on:{change:e.onChangeExactryMove},model:{value:e.exactlyMove,callback:function(t){e.exactlyMove=t},expression:"exactlyMove"}},[e._v("高速で壁に衝突しても、隙間が空かない。")])],1)},a=[],n=(r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("d4ec")),o=r("bee2"),s=r("2b0e"),h=r("22a2"),c=(r("18a5"),r("3835")),d=r("262e"),l=r("2caf"),u=r("426a"),p=function e(t,r,i){Object(n["a"])(this,e),this.moveX=t,this.moveY=r,this.nextDirection=i},f=function(){function e(t,r,i){Object(n["a"])(this,e),this.textureOffset=r,this.routine=i,this.x=0,this.y=0,this.hitCircle=new h["Circle"](0,0,12),this.hitRect=new h["Rectangle"](-12,-12,24,24),this.animationFrame=0,this._currentDirection=2,this.preUpdateInfo=null,this.animationStep=0,this.bodySprite=new u["a"],this.bodySprite.texture=new h["Texture"](t.baseTexture,new h["Rectangle"](r.x,r.y,32,64)),i.character=this,this.bodySprite.anchor.set(.5,1);var a=new h["Texture"](t.baseTexture,new h["Rectangle"](224,96,32,32));this.shadowSprite=h["Sprite"].from(a),this.shadowSprite.alpha=.5,this.shadowSprite.anchor.set(.5,.5),this.debugCircle=new h["Graphics"],this.debugCircle.lineStyle(2,16733525,1),this.debugCircle.alpha=.7,this.debugCircle.drawCircle(0,0,11),this.debugRect=new h["Graphics"],this.debugRect.lineStyle(2,5592575,1),this.debugRect.alpha=.7,this.debugRect.drawRect(this.hitRect.x,this.hitRect.y,this.hitRect.width,this.hitRect.height)}return Object(o["a"])(e,[{key:"currentDirection",get:function(){return this._currentDirection},set:function(e){this._currentDirection=e,this.syncTexture()}},{key:"syncTexture",value:function(){var e=0,t=0;switch(this.currentDirection){case 1:e=96;break;case 2:break;case 3:e=96,t=64;break;case 4:t=64;break;case 6:t=128;break;case 7:e=96,t=128;break;case 8:t=192;break;case 9:e=96,t=192;break}e+=32*(3===this.animationStep?1:this.animationStep);var r=new h["Rectangle"](this.textureOffset.x+e,this.textureOffset.y+t,32,64);this.bodySprite.texture.frame=r}},{key:"preUpdate",value:function(){this.routine.preUpdate()}},{key:"update",value:function(){var e=[this.x,this.y+8];this.bodySprite.x=e[0],this.bodySprite.y=e[1];var t=[this.x,this.y];this.shadowSprite.x=t[0],this.shadowSprite.y=t[1];var r=[this.x,this.y];this.hitCircle.x=r[0],this.hitCircle.y=r[1];var i=[this.x,this.y];this.debugCircle.x=i[0],this.debugCircle.y=i[1];var a=[this.x-12,this.y-12];this.hitRect.x=a[0],this.hitRect.y=a[1];var n=[this.x,this.y];this.debugRect.x=n[0],this.debugRect.y=n[1],this.bodySprite.zOrder=this.bodySprite.position.y,++this.animationFrame,this.animationFrame>30&&(this.animationFrame=0,this.animationStep=(this.animationStep+1)%4,this.syncTexture())}}]),e}(),v=function e(){Object(n["a"])(this,e)},y=37,m=38,g=39,C=40,b=function(e,t){var r=.7*t;switch(e){case 1:return[-r,r];case 2:return[0,t];case 3:return[r,r];case 4:return[-t,0];case 6:return[t,0];case 7:return[-r,-r];case 8:return[0,-t];case 9:return[r,-r]}return[0,0]},x=function(e){Object(d["a"])(r,e);var t=Object(l["a"])(r);function r(e){var i;return Object(n["a"])(this,r),i=t.call(this),i.pressedKeyCodeSet=e,i}return Object(o["a"])(r,[{key:"preUpdate",value:function(){var e=null;if(this.pressedKeyCodeSet.has(y)?e=this.pressedKeyCodeSet.has(C)?1:this.pressedKeyCodeSet.has(m)?7:4:this.pressedKeyCodeSet.has(g)?e=this.pressedKeyCodeSet.has(C)?3:this.pressedKeyCodeSet.has(m)?9:6:this.pressedKeyCodeSet.has(m)?e=8:this.pressedKeyCodeSet.has(C)&&(e=2),null!=e){var t=b(e,5),r=Object(c["a"])(t,2),i=r[0],a=r[1];this.character.preUpdateInfo=new p(i,a,e)}}}]),r}(v),w=function(e){Object(d["a"])(r,e);var t=Object(l["a"])(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(n["a"])(this,r),e=t.call(this),e.isMoving=i,e}return Object(o["a"])(r,[{key:"dash",value:function(){this.isMoving=!0}},{key:"stop",value:function(){this.isMoving=!1}},{key:"preUpdate",value:function(){this.isMoving&&(this.character.preUpdateInfo=new p(-15,0,4))}}]),r}(v),S=(r("4160"),r("45fc"),r("a9e3"),r("159b"),r("d820")),N=function(e){Object(d["a"])(r,e);var t=Object(l["a"])(r);function r(e){var i;Object(n["a"])(this,r),i=t.call(this),i.texture=e,i.exactlyMove=!1,i.horizontalGridNum=26,i.verticalGridNum=22,i.targetCharacter=null,i.characters=[],i.walls=[],i.sortableChildren=!0,i.bgLayerContainer=new h["ParticleContainer"](2e4,{uvs:!1}),i.layerContainer=new S["a"](2e4,{uvs:!0,vertices:!0,tint:!0}),i.debugLayerContainer=new h["Container"],i.debugLayerContainer.visible=!1,i.addChild(i.bgLayerContainer),i.addChild(i.layerContainer),i.addChild(i.debugLayerContainer);var a=e.clone();a.frame=new h["Rectangle"](176,0,16,16);for(var o=0;o<i.verticalGridNum;++o)for(var s=0;s<i.horizontalGridNum;++s){var c=h["Sprite"].from(a);c.position=new h["Point"](16*s,16*o),i.bgLayerContainer.addChild(c)}var d=e.clone();d.frame=new h["Rectangle"](176,48,16,48);var l=e.clone();l.frame=new h["Rectangle"](176,16,16,32);for(var u=1;u<i.horizontalGridNum-1;++u){var p=h["Sprite"].from(d);p.position.set(16*u,0),i.bgLayerContainer.addChild(p);var f=h["Sprite"].from(l);f.position.set(16*u,16*i.verticalGridNum-32),i.layerContainer.addChildZ(f,Number.MAX_VALUE)}var v=e.clone();v.frame=new h["Rectangle"](192,32,16,16);var y=e.clone();y.frame=new h["Rectangle"](160,32,16,32);for(var m=1;m<i.verticalGridNum-2;++m){var g=h["Sprite"].from(v);g.position.set(0,16*m),i.layerContainer.addChildZ(g,Number.MAX_VALUE);var C=h["Sprite"].from(y);C.position.set(16*i.horizontalGridNum-16,16*m),i.layerContainer.addChildZ(C,Number.MAX_VALUE)}var b=e.clone();b.frame=new h["Rectangle"](176,32,16,16);var x=e.clone();x.frame=new h["Rectangle"](192,64,16,16);var w=h["Sprite"].from(x);i.layerContainer.addChildZ(w,Number.MAX_VALUE);var N=e.clone();N.frame=new h["Rectangle"](208,64,16,16);var R=h["Sprite"].from(N);R.position.set(16*i.horizontalGridNum-16,0),i.layerContainer.addChildZ(R,Number.MAX_VALUE);var A=e.clone();A.frame=new h["Rectangle"](192,80,16,16);var k=h["Sprite"].from(A);k.position.set(0,16*i.verticalGridNum-32),i.layerContainer.addChildZ(k,Number.MAX_VALUE);var M=h["Sprite"].from(b);M.position.set(0,16*i.verticalGridNum-16),i.layerContainer.addChildZ(M,Number.MAX_VALUE);var E=e.clone();E.frame=new h["Rectangle"](208,80,16,16);var L=h["Sprite"].from(E);L.position.set(16*i.horizontalGridNum-16,16*i.verticalGridNum-32),i.layerContainer.addChildZ(L,Number.MAX_VALUE);var O=h["Sprite"].from(b);O.position.set(16*i.horizontalGridNum-16,16*i.verticalGridNum-16),i.layerContainer.addChildZ(O,Number.MAX_VALUE);var G=e.clone();G.frame=new h["Rectangle"](128,32,32,32);for(var I=0;I<3;++I){var _=h["Sprite"].from(G);_.position.set(16+32*I,192),i.layerContainer.addChildZ(_,_.position.y)}var U=e.clone();U.frame=new h["Rectangle"](224,80,16,16);for(var j=1;j<i.horizontalGridNum-1;++j){var T=h["Sprite"].from(U);T.alpha=.3,T.position.set(16*j,48),i.bgLayerContainer.addChild(T)}for(var D=4;D<i.verticalGridNum-1;++D){var K=h["Sprite"].from(U);K.alpha=.3,K.position.set(16,16*D),i.bgLayerContainer.addChild(K)}var W=e.clone();W.frame=new h["Rectangle"](240,64,16,16);var z=e.clone();z.frame=new h["Rectangle"](224,48,16,16);var V=e.clone();V.frame=new h["Rectangle"](240,80,16,16);for(var X=2;X<7;++X){var F=h["Sprite"].from(W);F.alpha=.3,F.position.set(16*X,224),i.bgLayerContainer.addChild(F)}var Z=h["Sprite"].from(V);Z.alpha=.3,Z.position.set(112,224),i.bgLayerContainer.addChild(Z);var P=h["Sprite"].from(z);P.alpha=.3,P.position.set(112,208),i.bgLayerContainer.addChild(P);var Y=e.clone();Y.frame=new h["Rectangle"](224,64,16,16);var $=h["Sprite"].from(Y);return $.alpha=.3,$.position.set(112,192),i.bgLayerContainer.addChild($),i.addWall(new h["Rectangle"](0,0,16,16*i.verticalGridNum)),i.addWall(new h["Rectangle"](16*i.horizontalGridNum-16,0,16,16*i.verticalGridNum)),i.addWall(new h["Rectangle"](16,0,16*i.horizontalGridNum-32,48)),i.addWall(new h["Rectangle"](16,16*i.verticalGridNum,16*i.horizontalGridNum-32,16)),i.addWall(new h["Rectangle"](16,192,96,32)),i.on("added",(function(){})),i}return Object(o["a"])(r,[{key:"addWall",value:function(e){this.walls.push(e);var t=new h["Graphics"];t.lineStyle(2,5592575,1),t.drawRect(e.x+1,e.y+1,e.width-2,e.height-2),this.debugLayerContainer.addChild(t)}},{key:"addCharacter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.characters.push(e),t&&(this.targetCharacter=e),this.layerContainer.addChildZ(e.bodySprite,1),this.layerContainer.addChildZ(e.shadowSprite,1),this.debugLayerContainer.addChild(e.debugCircle),this.debugLayerContainer.addChild(e.debugRect)}},{key:"update",value:function(){var e=this;this.characters.forEach((function(e){return e.preUpdate()})),this.characters.forEach((function(t){if(null!=t.preUpdateInfo){var r=[t.preUpdateInfo.moveX,t.preUpdateInfo.moveY],i=r[0],a=r[1];if(0!=i||0!=a)if(e.exactlyMove){var n=e.hitOtherCaracter(t,i,a),o=Object(c["a"])(n,2),s=o[0],h=o[1];s&&(i-=i*h,a-=a*h);var d=e.hitWall(t,i,a),l=Object(c["a"])(d,3),u=l[0],p=l[1],f=l[2];u?0===p||0===f?(t.x+=i-p,t.y+=a-f):e.hitWall(t,0,a)[0]?e.hitWall(t,i,0)[0]||(t.x+=i,t.y+=a-f):(t.y+=a,t.x+=i-p):(t.x+=i,t.y+=a)}else e.hitOtherCaracter(t,i,a)[0]||(e.hitWall(t,i,a)[0]?e.hitWall(t,0,a)[0]?e.hitWall(t,i,0)[0]||(t.x+=i):t.y+=a:(t.x+=i,t.y+=a));t.currentDirection=t.preUpdateInfo.nextDirection,t.preUpdateInfo=null,t.update()}else t.update()}));var t=224,r=96,i=144,a=96;if(this.targetCharacter){var n=this.targetCharacter.x+this.x;n>t?this.x=-(this.targetCharacter.x-t):n<r&&(this.x=-(this.targetCharacter.x-r));var o=this.targetCharacter.y+this.y;o>i?this.y=-(this.targetCharacter.y-i):o<a&&(this.y=-(this.targetCharacter.y-a))}this.x=Math.floor(Math.min(0,Math.max(-(16*this.horizontalGridNum-320),this.x))),this.y=Math.floor(Math.min(0,Math.max(-(16*this.verticalGridNum-240),this.y))),this.layerContainer.sortChildren()}},{key:"hitOtherCaracter",value:function(e,t,r){var i=e.hitCircle.clone();i.x+=t,i.y+=r;var a=0,n=this.characters.some((function(t){if(e===t)return!1;var r=[i.x,i.y,t.hitCircle.x,t.hitCircle.y],n=r[0],o=r[1],s=r[2],h=r[3];a=i.radius+t.hitCircle.radius-Math.sqrt(Math.pow(s-n,2)+Math.pow(h-o,2));var c=a>=0;return c}));return[n,n?a/Math.sqrt(Math.pow(t,2)+Math.pow(r,2)):0]}},{key:"hitWall",value:function(e,t,r){var i=e.hitRect.clone();i.x+=t,i.y+=r;var a=0,n=0,o=this.walls.some((function(e){var o=i.left<e.right&&i.right>e.left,s=i.top<e.bottom&&i.bottom>e.top,h=o&&s;return h&&(t<0?a=i.left-e.right:t>0&&(a=i.right-e.left),r<0?n=i.top-e.bottom:r>0&&(n=i.bottom-e.top)),h}));return[o,a,n]}},{key:"setDebugMode",value:function(e){this.debugLayerContainer.visible=e}}]),r}(h["Container"]),R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();Object(n["a"])(this,e),this.oldNow=t,this.ms=0,this.counter=0,this.averageMs=0}return Object(o["a"])(e,[{key:"checkPoint",value:function(){var e=performance.now();this.ms+=e-this.oldNow,this.oldNow=e,++this.counter,this.counter>=60&&(this.averageMs=this.ms/this.counter,this.counter=0,this.ms=0)}}]),e}(),A=s["default"].extend({data:function(){return{pixiApp:null,field:null,pressedKeyCodeSet:new Set,fpsCounter:new R,npc:null,exactlyMove:!1}},mounted:function(){var e=this;h["settings"].RESOLUTION=window.devicePixelRatio,h["settings"].SCALE_MODE=h["SCALE_MODES"].NEAREST,window.onkeydown=this.onKeyDown,window.onkeyup=this.onKeyUp;var t={width:320,height:240};this.pixiApp=new h["Application"](t),this.pixiApp.ticker.maxFPS=60,this.pixiApp.ticker.minFPS=60;var r=this.$refs["pixi_area"];r.appendChild(this.pixiApp.view);var i=new h["Sprite"](h["Texture"].WHITE);i.width=320,i.height=240,i.tint=13421772,this.pixiApp.stage.addChild(i),h["utils"].clearTextureCache(),h["Loader"].shared.reset().add("/arpg-sample/images/stages/009/chara01.png").add("/arpg-sample/images/stages/009/chara02.png").add("/arpg-sample/images/stages/009/mapchip.png").load((function(){var t=h["RenderTexture"].create({width:512,height:512}),r=(h["Sprite"].from(t),h["Sprite"].from(h["Loader"].shared.resources["/arpg-sample/images/stages/009/mapchip.png"].texture));e.pixiApp.renderer.render(r,t,!1);var i=h["Sprite"].from(h["Loader"].shared.resources["/arpg-sample/images/stages/009/chara01.png"].texture);i.position.set(0,128),e.pixiApp.renderer.render(i,t,!1);var a=h["Sprite"].from(h["Loader"].shared.resources["/arpg-sample/images/stages/009/chara02.png"].texture);a.position.set(192,128),e.pixiApp.renderer.render(a,t,!1),e.field=new N(t),e.pixiApp.stage.addChild(e.field);var n=new f(t,new h["Point"](0,128),new x(e.pressedKeyCodeSet));n.x=200,n.y=120,e.field.addCharacter(n,!0),e.npc=new f(t,new h["Point"](192,128),new w),e.npc.x=272,e.npc.y=208,e.npc.currentDirection=4,e.field.addCharacter(e.npc),e.field.setDebugMode(!0)})),this.pixiApp.ticker.add(this.update)},methods:{onKeyDown:function(e){this.pressedKeyCodeSet.add(e.keyCode)},onKeyUp:function(e){this.pressedKeyCodeSet["delete"](e.keyCode)},update:function(e){this.fpsCounter.checkPoint(),null!=this.field&&this.field.update()},onClickRun:function(){this.npc.routine.dash()},onClickReset:function(){this.npc.routine.stop(),this.npc.x=272,this.npc.y=208,this.npc.currentDirection=4},onChangeExactryMove:function(e){this.field.exactlyMove=e}},beforeDestroy:function(){this.pixiApp.destroy(!0)},components:{},computed:{},props:[]}),k=A,M=(r("6ca0"),r("2877")),E=Object(M["a"])(k,i,a,!1,null,"bd04271a",null);t["default"]=E.exports},"45fc":function(e,t,r){"use strict";var i=r("23e7"),a=r("b727").some,n=r("a640"),o=r("ae40"),s=n("some"),h=o("some");i({target:"Array",proto:!0,forced:!s||!h},{some:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var i=r("1d80"),a=r("5899"),n="["+a+"]",o=RegExp("^"+n+n+"*"),s=RegExp(n+n+"*$"),h=function(e){return function(t){var r=String(i(t));return 1&e&&(r=r.replace(o,"")),2&e&&(r=r.replace(s,"")),r}};e.exports={start:h(1),end:h(2),trim:h(3)}},"6ca0":function(e,t,r){"use strict";r("1129")},a9e3:function(e,t,r){"use strict";var i=r("83ab"),a=r("da84"),n=r("94ca"),o=r("6eeb"),s=r("5135"),h=r("c6b6"),c=r("7156"),d=r("c04e"),l=r("d039"),u=r("7c73"),p=r("241c").f,f=r("06cf").f,v=r("9bf2").f,y=r("58a8").trim,m="Number",g=a[m],C=g.prototype,b=h(u(C))==m,x=function(e){var t,r,i,a,n,o,s,h,c=d(e,!1);if("string"==typeof c&&c.length>2)if(c=y(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+c}for(n=c.slice(2),o=n.length,s=0;s<o;s++)if(h=n.charCodeAt(s),h<48||h>a)return NaN;return parseInt(n,i)}return+c};if(n(m,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var w,S=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof S&&(b?l((function(){C.valueOf.call(r)})):h(r)!=m)?c(new g(x(t)),r,S):x(t)},N=i?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),R=0;N.length>R;R++)s(g,w=N[R])&&!s(S,w)&&v(S,w,f(g,w));S.prototype=C,C.constructor=S,o(a,m,S)}}}]);
//# sourceMappingURL=chunk-19226302.ebe26ee3.js.map